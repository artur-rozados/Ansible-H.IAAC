---

- hosts: Jetsons  # Roda o Playbook em todas as Jetsons
  become: yes

  tasks:

  - name: Garantir que o Git está instalado
    ansible.builtin.apt:
      name: git 
      state: present # Verifica que o git está instalado, e instala se não estiver
      update_cache: yes
    tags:
      - prerequisites


  - name: Clonar repositório
    ansible.builtin.git:
      repo: "https://github.com/artur-rozados/Ansible-H.IAAC.git"
      dest: ""  # Onde será clonado
      version: main  # Garante que o repositório está no branch 'main' mais recente
      force: yes     # Força o checkout, descartando alterações locais nas Pis
      update: yes    # Garante que o 'git pull' será executado se o repo já existir
    become_user:   # Executa esta tarefa específica como o usuário 'pi'
    tags:
      - git